# ⚠️ ERR_CONNECTION_REFUSED 错误说明

## 📍 问题原因

**你无法在本地浏览器访问 http://localhost:8000！**

### 为什么？

| 项目 | 说明 |
|------|------|
| **服务位置** | Coze 云端沙箱 |
| **你的位置** | 本地电脑 |
| **localhost** | 指向你自己的电脑，不是云端沙箱 |
| **端口 8000** | 在云端沙箱中监听，不在你本地 |

---

## 🔄 网络连接示意

```
你的本地电脑
    ↓  浏览器访问 http://localhost:8000
    ↓  尝试连接本地 8000 端口
    ❌ 失败：本地没有运行这个服务！

---

云端沙箱（Coze 平台）
    ↓  服务正在运行
    ↓  监听 0.0.0.0:8000
    ✅ 服务正常，但你在本地无法直接访问
```

---

## ✅ 解决方案

### 方案1：在云端沙箱中测试（推荐用于开发测试）

**使用 curl 在沙箱中测试服务：**

```bash
# 健康检查
curl http://localhost:8000/health

# 测试智能体
curl -X POST http://localhost:8000/run \
  -H "Content-Type: application/json" \
  -d '{
    "type": "query",
    "session_id": "test",
    "content": {
      "query": {
        "prompt": [{
          "type": "text",
          "content": {"text": "你好"}
        }]
      }
    }
  }'
```

---

### 方案2：部署到公网（推荐用于分享）

#### A. 部署智能体到 Coze 平台

1. 访问 Coze 平台：https://www.coze.cn
2. 创建工作流
3. 导入 Gitee 仓库：https://gitee.com/spiritor/simplecal
4. 配置并启动
5. 获取公网分享链接

#### B. 部署游戏到 Vercel

1. 访问 Vercel：https://vercel.com
2. 导入 Gitee 仓库
3. 自动部署
4. 获取公网游戏链接

---

### 方案3：使用端口转发（高级用户）

如果你有 SSH 访问权限：

```bash
# 在你的本地电脑上执行
ssh -L 8000:localhost:8000 your-cloud-server

# 然后在浏览器访问
http://localhost:8000
```

**注意**：Coze 沙箱通常不提供 SSH 访问，这个方案可能不适用。

---

## 📊 对比说明

| 访问方式 | 位置 | 可访问性 | 适用场景 |
|---------|------|---------|---------|
| **本地浏览器访问 localhost** | 本地电脑 | ❌ 无法访问 | 不适用 |
| **云端沙箱中 curl 访问** | 云端沙箱 | ✅ 可以访问 | 开发测试 |
| **部署到 Coze 平台** | 公网 | ✅ 可以访问 | 分享使用 |
| **部署到 Vercel** | 公网 | ✅ 可以访问 | 游戏分享 |

---

## 🎯 推荐做法

### 对于开发和测试

**在云端沙箱中使用 curl 测试：**

```bash
# 测试健康检查
curl http://localhost:8000/health

# 测试智能体对话
curl -X POST http://localhost:8000/run \
  -H "Content-Type: application/json" \
  -d '{
    "type": "query",
    "session_id": "test",
    "content": {
      "query": {
        "prompt": [{
          "type": "text",
          "content": {"text": "出几道简便运算练习题"}
        }]
      }
    }
  }'
```

---

### 对于分享给同学

**部署到公网平台：**

1. **部署智能体到 Coze**
   - 访问 https://www.coze.cn
   - 导入 Gitee 仓库
   - 获取分享链接

2. **部署游戏到 Vercel**
   - 访问 https://vercel.com
   - 导入 Gitee 仓库
   - 获取游戏链接

---

## 💡 为什么会这样？

### Coze 沙箱的特点

1. **隔离环境**
   - 沙箱运行在云端服务器上
   - 与你的本地电脑隔离
   - 无法直接访问

2. **安全考虑**
   - 防止未授权访问
   - 保护沙箱资源
   - 符合安全规范

3. **设计目的**
   - 用于代码开发和测试
   - 不是用于直接提供 HTTP 服务
   - 需要部署到正式平台才能对外服务

---

## 🚀 下一步行动

### 现在：在沙箱中测试

让我帮你测试服务是否正常：

```bash
# 1. 健康检查
curl http://localhost:8000/health

# 2. 测试智能体
curl -X POST http://localhost:8000/run \
  -H "Content-Type: application/json" \
  -d '{
    "type": "query",
    "session_id": "test",
    "content": {
      "query": {
        "prompt": [{
          "type": "text",
          "content": {"text": "出几道简便运算题目"}
        }]
      }
    }
  }'
```

### 之后：部署到公网

按照部署指南：
- 查看 `docs/部署指南.md`
- 部署到 Coze 平台
- 部署到 Vercel
- 获取公网链接

---

## ❓ 常见问题

### Q1: 我为什么不能直接在浏览器访问？
**A**: 因为服务在云端沙箱中，不在你的本地电脑上。

### Q2: 如何在浏览器中访问？
**A**: 需要部署到公网平台（Coze、Vercel 等）。

### Q3: 服务现在有用吗？
**A**: 有用！可以在沙箱中用 curl 测试，验证功能是否正常。

### Q4: 什么时候可以分享给同学？
**A**: 部署到 Coze 和 Vercel 后，就可以分享了。

---

## 📖 相关文档

- **部署指南**：`docs/部署指南.md`
- **HTTP 服务说明**：`docs/HTTP服务启动说明.md`
- **推送成功文档**：`docs/推送成功.md`

---

## 🎯 总结

**重要事实：**
1. ❌ 无法在本地浏览器访问 http://localhost:8000
2. ✅ 服务在云端沙箱中正常运行
3. ✅ 可以在沙箱中用 curl 测试
4. ✅ 需要部署到公网才能分享

**推荐做法：**
1. 在沙箱中用 curl 测试服务
2. 按照部署指南部署到公网
3. 获取公网链接后分享给同学

---

**现在让我帮你测试服务是否正常！** 🧪
